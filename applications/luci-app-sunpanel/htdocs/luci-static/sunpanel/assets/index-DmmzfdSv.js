import{j as q,b2 as c,b6 as $,b7 as n,bb as u,b4 as k,b8 as i,b9 as l,b5 as te,ba as e,bS as K,bp as ae,bq as se,bG as A,r as m,bH as oe,bx as ne,bo as re,bI as le,H as ue,b3 as v,bc as r,as as w,bj as t,af as g,bd as B,bU as ie,k as Y}from "./index-Cr6VSFOe.js";import{C as j,q as D,E as U}from "./index-DEZ9xjST.js";import{a as pe,_ as de}from "./index.vue_vue_type_script_setup_true_lang-GZDTfTwy.js";import{i as H,c as ce,a as he}from "./index-BfqqEllV.js";import{_ as fe}from "./_plugin-vue_export-helper-DlAUqK2U.js";import{e as me,g as ge,b as R,N as V}from "./index-B9C2E4-e.js";import{N as ve}from "./Alert-BHC7xqF2.js";const ye= p=>(ae("data-v-e80c1148"),p=p(),se(),p),xe={class:"flex text-xl mb-5"},_e={class:"ml-auto"},Ae={class:"flex justify-end mt-10 text-xs"},Se=ye(()=>u("div",{class:"card-pattern"},null,-1)),be=q({__name:"index",props:{nickName:null,proFlag:null,username:null,expired:null,cardStyle:null},setup(p){return(d, h)=>(c(),$(e(K),{style:te(p.cardStyle),class:"card"},{default:n(()=>[u("div",xe,[u("span",null,[k(d.$slots,"nickName",{},()=>[i(l(p.nickName),1)],!0)]),u("span",_e,[k(d.$slots,"proFlag",{},()=>[i(l(p.proFlag),1)],!0)])]),u("div",null,[k(d.$slots,"username",{},()=>[i(l(p.username),1)],!0)]),u("div",Ae,[k(d.$slots,"expired",{},()=>[i(l(p.expired),1)],!0)]),Se]),_:3},8,["style"]))}}),ke=fe(be,[["__scopeId","data-v-e80c1148"]]);function we(p, d){return A({url:"/panel/proAuth/login",data:{username:p,password:d}})}function $e(){return A({url:"/panel/proAuth/logout"})}function Ce(){return A({url:"/panel/proAuth/getStatus"})}function Ne(){return A({url:"/panel/proAuth/refreshStatus"})}function Pe(p){return A({url:"/panel/proAuth/setHideProBadgeStatus",data:{status:p}})}const ze={class:"bg-slate-200 dark:bg-zinc-900 p-2 h-full"},Ee={class:"flex justify-center"},Be={class:"m-5 w-[300px]"},De={key:1,class:"cursor-pointer"},Le={key:0,class:"flex items-center"},Fe=["title"],Ie={class:"text-white"},Me={key:0,class:"my-2 flex justify-center"},Te={class:"mt-2 flex justify-center"},Ye={class:"mx-2"},je={class:"my-2 text-center"},Ue=u("br",null,null,-1),He={class:"flex items-center"},Re=["onKeydown"],Je=q({__name:"index",setup(p){const d=m(!1),h=m({username:"",password:""}),S=oe(),O=ne(),f=re(),Q=le(),C=m(!1),x=m(!1),y=m(""),W=m(!1),N=m(),P=m(!1),G={backgroundColor:"#F0A020",color:"white",textShadow:"1px 1px 1px #5d5c5c"},L={backgroundColor:"rgb(118, 124, 130)",color:"white",textShadow:"1px 1px 1px #5d5c5c"},z=m(L);async function b(){try{const{data:o}=await Ce();x.value=o.loginStatus,y.value=o.proExpiration||"",T(y.value)?z.value=L:z.value=G,N.value={username:o.username,nickName:o.nickName}}catch(o){console.error(o)}}async function J(o, a){C.value=!0,await we(o,a).then(()=>{b(),d.value=!1}).catch(s=>{if(s.code===1414){S.error(t("apps.proAuth.serverError"));return}D(s)}),f.refreshProAuthStatus(),C.value=!1}async function F(){await $e().then(()=>{b(),d.value=!1,f.refreshProAuthStatus()})}async function X(){P.value=!0,await Ne().then(()=>{b()}).catch(o=>{if(o.code===1009){S.error(()=>[Y("span",`${t("apps.proAuth.tokenExpired")}`),Y(g,{onClick:()=>{const{faqLinkWithLang:a}=he();window.open(a("proAccountInvalid"))},type:"error",style:{marginLeft:"10px"},size:"tiny"},t("common.viewReason"))],{duration:6e4,closable:!0}),F();return}else if(o.code===1414){S.error(t("apps.proAuth.serverError"));return}D(o)}),f.refreshProAuthStatus(),P.value=!1}function Z(){O.warning({title:t("common.warning"),content:t("apps.proAuth.logoutConfirm"),positiveText:t("common.confirm"),negativeText:t("common.cancel"),onPositiveClick:()=>{(async()=>{try{F()}catch(a){D(a)}})()}})}function I(){d.value=!0}function M(){if(h.value.username===""||h.value.password===""){S.error(t("apps.proAuth.usernameWithPasswordIsNotEmpty"));return}J(h.value.username||"",h.value.password||"")}function _(o){window.open(`http://links.sun-panel.top/${o}`)}function E(){return Q.language==="zh-CN"?"zh_cn":"en"}async function ee(o){f.isExpired||await Pe(o),f.refreshProAuthStatus()}function T(o){const a=U(),s=U(o);return!!(o===""||a.isAfter(s))}return ue(()=>{b()}),(o, a)=>(c(),v("div",ze,[r(e(K),{style:{"border-radius":"10px"},size:"small"},{default:n(()=>[u("div",Ee,[u("div",Be,[r(e(ke),{"card-style":z.value,class:"dark:brightness-90"},{nickName:n(()=>{var s;return[x.value?(c(),v(w,{key:0},[i(l((s=N.value)==null?void 0:s.nickName),1)],64)):(c(),v("div",De,[u("span",{onClick:I},l(e(t)("apps.proAuth.notLogin")),1)]))]}),proFlag:n(()=>[i(" PRO ")]),username:n(()=>{var s;return[x.value?(c(),v("div",Le,[u("span",null,l((s=N.value)==null?void 0:s.username),1),u("span",{class:"cursor-pointer ml-2",title:e(t)("apps.proAuth.logout"),onClick:Z},[r(e(H),{icon:"tabler:logout",class:"w-[20px] h-[20px]",title:e(t)("apps.proAuth.logout")},null,8,["title"])],8,Fe)])):(c(),$(e(g),{key:1,size:"small",ghost:"",type:"success",onClick:I},{default:n(()=>[r(e(pe),{style:{"max-width":"200px"}},{default:n(()=>[u("span",Ie,l(e(t)("apps.proAuth.loginSunPanel")),1)]),_:1})]),_:1}))]}),expired:n(()=>[x.value?(c(),v(w,{key:0},[!y.value||y.value===""?(c(),$(e(g),{key:0,type:"primary",dashed:"",size:"tiny",onClick:a[0]||(a[0]= s=>_("proAuthSite"))},{default:n(()=>[i(l(e(t)("apps.proAuth.card.upgradePRO")),1)]),_:1})):T(y.value)?(c(),v(w,{key:1},[i(l(e(t)("apps.proAuth.card.expiredText",{date:e(j)(y.value,"YYYY-MM-DD")})),1)],64)):(c(),v(w,{key:2},[i(l(e(t)("apps.proAuth.card.notExpiredText",{date:e(j)(y.value,"YYYY-MM-DD")})),1)],64))],64)):B("",!0)]),_:1},8,["card-style"]),x.value?(c(),v("div",Me,[r(e(g),{size:"tiny",style:{"margin-right":"5px"},loading:P.value,onClick:X},{icon:n(()=>[r(e(H),{icon:"ic:baseline-refresh"})]),default:n(()=>[i(" "+l(e(t)("apps.proAuth.refreshAuth")),1)]),_:1},8,["loading"])])):B("",!0),u("div",Te,[u("span",Ye,l(e(t)("apps.proAuth.hideProBadgeText")),1),r(e(me),{value:e(f).hideProBadge,"onUpdate:value":[a[1]||(a[1]= s=>e(f).hideProBadge=s),ee],disabled:e(f).isExpired,loading:W.value},null,8,["value","disabled","loading"])])])]),r(e(ce),{class:"!my-2"}),u("div",je,[r(e(g),{size:"small",style:{margin:"2px"},onClick:a[2]||(a[2]= s=>_(`proAuthSite_${E()}`))},{default:n(()=>[i(l(e(t)("apps.proAuth.goToSunPanelAuthSite")),1)]),_:1}),r(e(g),{size:"small",style:{margin:"2px"},onClick:a[3]||(a[3]= s=>_(`funcDescription_${E()}`))},{default:n(()=>[i(l(e(t)("apps.proAuth.funcDescription")),1)]),_:1}),r(e(g),{size:"small",style:{margin:"2px"},onClick:a[4]||(a[4]= s=>_(`proAuthSiteFAQ_${E()}`))},{default:n(()=>[i(l(e(t)("apps.proAuth.FAQButton")),1)]),_:1})]),e(f).hideProBadge?B("",!0):(c(),$(e(ve),{key:0,bordered:!1,"show-icon":!1},{default:n(()=>[i(l(e(t)("apps.proAuth.textDescription")),1)]),_:1})),Ue,r(e(de),{show:d.value,"onUpdate:show":a[8]||(a[8]= s=>d.value=s),style:{width:"400px"},title:e(t)("apps.proAuth.loginSunPanel")},{default:n(()=>[u("div",He,[u("div",null,[r(e(g),{size:"tiny",type:"info",onClick:a[5]||(a[5]= s=>_("proAuthSiteRegister"))},{default:n(()=>[i(l(e(t)("apps.proAuth.registerAccount")),1)]),_:1})])]),u("div",{class:"mt-2",onKeydown:ie(M,["enter"])},[r(e(ge),null,{default:n(()=>[r(e(R),{label:e(t)("apps.proAuth.username")},{default:n(()=>[r(e(V),{value:h.value.username,"onUpdate:value":a[6]||(a[6]= s=>h.value.username=s),placeholder:e(t)("apps.proAuth.username")},null,8,["value","placeholder"])]),_:1},8,["label"]),r(e(R),{label:e(t)("apps.proAuth.password")},{default:n(()=>[r(e(V),{value:h.value.password,"onUpdate:value":a[7]||(a[7]= s=>h.value.password=s),type:"password",placeholder:e(t)("apps.proAuth.password")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),r(e(g),{type:"primary",loading:C.value,block:"",secondary:"",strong:"",onClick:M},{default:n(()=>[i(l(e(t)("apps.proAuth.login")),1)]),_:1},8,["loading"])],40,Re)]),_:1},8,["show","title"])]),_:1})]))}});export{Je as default};
