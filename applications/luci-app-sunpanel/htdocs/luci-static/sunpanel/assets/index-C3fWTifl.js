import{j as R,r as u,b2 as x,b6 as V,ba as a,bv as D,bI as H,bw as K,bu as F,bX as O,bH as W,c as X,bW as N,H as Y,bi as B,b3 as Z,bb as r,b5 as G,bc as t,b7 as o,bY as J,bV as Q,br as ee,b9 as T,bU as ae,bj as $,bd as te,af as se,b8 as E,bS as ne,bZ as oe,bp as le,bq as re}from "./index-Cr6VSFOe.js";import{k as ie,x as M,q as P,S as p}from "./index-DEZ9xjST.js";import{e as ue,d as ce,l as de,g as pe,b,N as w}from "./index-B9C2E4-e.js";import{_ as ge}from "./_plugin-vue_export-helper-DlAUqK2U.js";const fe=R({__name:"index",props:{src:null},emits:["click","refresh"],setup(c, {expose:m,emit:d}){const s=u("0");function h(){s.value=String(_(100,99999)),d("click")}function _(g, v){return Math.floor(Math.random()*(v-g))+g}return m({refresh(){console.log("刷新验证码"),h()}}),(g, v)=>(x(),V(a(ie),{src:`${c.src}?${s.value}`,"preview-disabled":!0,onClick:h},null,8,["src"]))}}),me= c=>(le("data-v-e007e2b4"),c=c(),re(),c),he={class:"login-container"},ve={class:"mb-5 flex items-center justify-end"},be={class:"w-full"},_e={class:"mr-1"},Se={class:"min-w-[100px]"},ke={class:"login-title"},ye={class:"w-[130px] h-[40px] mr-[20px] rounded border flex cursor-pointer"},we=me(()=>r("div",{class:"copyright flex justify-center text-current"},[E(" Powered By "),r("a",{href:"https://github.com/hslr-s/sun-panel",target:"_blank",class:"ml-[5px]"},"Sun-Panel")],-1)),xe=R({__name:"index",setup(c){const m=J(),d=D(),s=H(),h=K(),_=F(),g=O(),v=W(),f=u(!1),S=u(m.query.username||""),C=u(null),k=X(()=>s.theme==="auto"?g.value==="dark":s.theme==="dark"),y=u(s.language),L=u(N().siteSetting),U=u(),l=u({username:S.value,password:""}),I=async()=>{f.value=!0;try{const e=await oe(l.value);e.code===0?(d.setToken(e.data.token),d.setUserInfo(e.data),h.reset(),_.addAccount({username:e.data.username||l.value.username,name:e.data.name||"",id:e.data.id||0,cToken:e.data.token,loginStatus:!0}),setTimeout(()=>{v.success(`Hi ${e.data.name},${$("login.welcomeMessage")}`),f.value=!1,B.push({path:"/"})},500)):f.value=!1}catch(e){s.siteSetting.isEnableLoginCaptcha&&U.value.refresh(),P(e),f.value=!1}};function j(e){e.keyCode!==229&&e.key==="Enter"&&!e.isComposing&&I()}function q(e){y.value=e,s.setLanguage(e),history.go(0)}async function A(){try{const{data:e}=await Q(),n=N().siteSetting;e.title===""&&(e.title=n.title),e.loginBackgroundUrl===""&&(e.loginBackgroundUrl=n.loginBackgroundUrl),s.setSiteSetting(e),L.value=e,M(e.title)}catch(e){P(e)}}function z(e){s.setTheme(e?"dark":"light")}return Y(()=>{var e;M(s.siteSetting.title),A(),S.value!==""&&(l.value.username=S.value,(e=C.value)==null||e.focus()),m.query.type!=="addLogin"&&d.token!==null&&d.token!==""&&B.push({path:"/"})}),(e, n)=>(x(),Z("div",null,[r("div",{class:"background",style:G({backgroundImage:`url('${a(s).siteSetting.loginBackgroundUrl}')`})},null,4),r("div",he,[t(a(ne),{class:"login-card",style:{"border-radius":"20px"}},{default:o(()=>[r("div",ve,[r("div",be,[t(a(ue),{value:a(k),"onUpdate:value":[n[0]||(n[0]= i=>ee(k)?k.value=i:null),z]},{"checked-icon":o(()=>[t(a(p),{icon:"mingcute:moon-fog-line"})]),"unchecked-icon":o(()=>[t(a(p),{icon:"mingcute:sun-fog-line"})]),default:o(()=>[t(a(p),{icon:"tabler-sun-filled"})]),_:1},8,["value"])]),r("div",_e,[t(a(p),{icon:"flowbite-language-outline",style:{width:"22px",height:"22px"},class:"language-text-style"})]),r("div",Se,[t(a(ce),{value:y.value,"onUpdate:value":n[1]||(n[1]= i=>y.value=i),size:"small",options:a(de),onUpdateValue:q},null,8,["value","options"])])]),r("div",ke,T(a(s).siteSetting.title)+" ",1),t(a(pe),{model:l.value,"label-width":"100px",onKeydown:ae(j,["enter"])},{default:o(()=>[t(a(b),null,{default:o(()=>[t(a(w),{value:l.value.username,"onUpdate:value":n[2]||(n[2]= i=>l.value.username=i),placeholder:e.$t("login.usernamePlaceholder")},{prefix:o(()=>[t(a(p),{icon:"ph:user-bold"})]),_:1},8,["value","placeholder"])]),_:1}),t(a(b),null,{default:o(()=>[t(a(w),{ref_key:"inputpasswordRef",ref:C,value:l.value.password,"onUpdate:value":n[3]||(n[3]= i=>l.value.password=i),type:"password",placeholder:e.$t("login.passwordPlaceholder")},{prefix:o(()=>[t(a(p),{icon:"mdi:password-outline"})]),_:1},8,["value","placeholder"])]),_:1}),a(s).siteSetting.isEnableLoginCaptcha?(x(),V(a(b),{key:0},{default:o(()=>[r("div",ye,[t(a(fe),{ref_key:"captchaRef",ref:U,src:"/api/captcha/getImage"},null,512)]),t(a(w),{value:l.value.vcode,"onUpdate:value":n[4]||(n[4]= i=>l.value.vcode=i),size:"large",type:"text",clearable:"",placeholder:a($)("login.captchaCodePlaceholder")},null,8,["value","placeholder"])]),_:1})):te("",!0),t(a(b),{style:{"margin-top":"10px"}},{default:o(()=>[t(a(se),{loading:f.value,class:"login-button",onClick:I},{default:o(()=>[E(T(e.$t("login.loginButton")),1)]),_:1},8,["loading"])]),_:1}),we]),_:1},8,["model","onKeydown"])]),_:1})])]))}}),Be=ge(xe,[["__scopeId","data-v-e007e2b4"]]);export{Be as default};
