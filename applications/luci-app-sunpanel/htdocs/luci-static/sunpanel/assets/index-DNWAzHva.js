import{bP as V,r as b,d2 as q,bG as w,j as z,bH as D,H as P,b2 as J,b6 as K,b7 as l,bc as t,ba as e,b8 as u,b9 as o,bj as d,bb as a,af as x,bS as T,bv as Q,bW as X,b3 as Y,bF as F,b5 as Z,d3 as ee,bp as te,bq as ae}from "./index-Cr6VSFOe.js";import{f as k,i as se,j as N,c as I,k as le,l as oe,_ as ne}from "./index-BfqqEllV.js";import{q as B,k as ie}from "./index-DEZ9xjST.js";import{N as L}from "./headers-UeR2h-d_.js";import{N as R}from "./Popconfirm-BTjgFvlF.js";import{N as re}from "./Alert-BHC7xqF2.js";import{N as E,e as j}from "./index-B9C2E4-e.js";import{N as ce}from "./ButtonGroup-aSgwB34R.js";import{_ as de}from "./_plugin-vue_export-helper-DlAUqK2U.js";import"./index.vue_vue_type_script_setup_true_lang-GZDTfTwy.js";const W=V("globalSitesetting",()=>{const p=b(!0);async function h(){try{const{data:f}=await q();p.value=f.isExpired}catch{}}return h(),{proIsExpired:p}});function ue(p){return w({url:"/panel/globalSetting/saveSiteStting",data:p})}function pe(){return w({url:"/panel/globalSetting/getSiteStting"})}function ge(){return w({url:"/panel/globalSetting/getCustomStylePath"})}function me(){return w({url:"/panel/globalSetting/getCustomJsAndCssCode"})}function fe(p){return w({url:"/panel/globalSetting/saveCustomJsAndCssCode",data:p})}const ve={class:"max-w-[400px]"},be={class:"text-sm"},he={class:"text-slate-500 my-[5px] font-bold"},Se={class:"flex items-center mt-[5px]"},_e={class:"text-slate-500 my-[5px] font-bold"},xe={class:"flex items-center mt-[5px]"},Ce={class:"mt-5 flex justify-end"},ye=z({__name:"Custom",setup(p){const h=W(),f=D(),v=b(""),m={jsContent:"",cssContent:""},g=b({...m});async function S(){await C(),$()}async function C(){try{await fe(g.value),f.success(d("common.saveSuccess"))}catch(c){B(c),console.log(c)}}function r(){g.value={...m}}async function $(){try{const{data:c}=await me();g.value=c}catch(c){B(c),console.log(c)}}async function U(){try{const{data:c}=await ge();v.value=c.customPath}catch(c){console.log(c)}}return P(()=>{U(),$()}),(c, _)=>(J(),K(e(T),{style:{"border-radius":"10px"},class:"mt-[10px]",size:"small"},{default:l(()=>[t(e(L),null,{default:l(()=>[u(o(e(d)("apps.globalSetting.customJSAndCss"))+" ",1),t(e(k),{"show-icon":""},{default:l(()=>[a("div",ve,o(e(d)("apps.globalSetting.customJSAndCssAlert",{path:v.value})),1)]),_:1})]),_:1}),t(e(re),{type:"error",bordered:!1,style:{"border-radius":"5px"}},{icon:l(()=>[t(e(se),{icon:"gg:danger"})]),default:l(()=>[a("span",be,o(e(d)("apps.globalSetting.customDangerAlert")),1)]),_:1}),t(e(N),{show:e(h).proIsExpired},{default:l(()=>[a("div",he," JS ("+o(`${v.value}/index.js`)+") ",1),a("div",Se,[t(e(E),{value:g.value.jsContent,"onUpdate:value":_[0]||(_[0]= y=>g.value.jsContent=y),type:"textarea",clearable:""},null,8,["value"])]),t(e(I)),a("div",_e," CSS ("+o(`${v.value}/index.css`)+") ",1),a("div",xe,[t(e(E),{value:g.value.cssContent,"onUpdate:value":_[1]||(_[1]= y=>g.value.cssContent=y),type:"textarea",clearable:""},null,8,["value"])]),a("div",Ce,[t(e(R),{onPositiveClick:r},{trigger:l(()=>[t(e(x),{size:"small",type:"error"},{default:l(()=>[u(o(e(d)("common.reset")),1)]),_:1})]),default:l(()=>[u(" "+o(c.$t("apps.globalSetting.resetWarnText")),1)]),_:1}),t(e(x),{size:"small",type:"success",class:"ml-[10px]",style:{"margin-left":"5px"},onClick:S},{default:l(()=>[u(o(e(d)("common.save")),1)]),_:1})])]),_:1},8,["show"])]),_:1}))}}),Ie= p=>(te("data-v-b08a437c"),p=p(),ae(),p),we={class:"bg-slate-200 dark:bg-zinc-900 rounded-[10px] p-[8px] overflow-auto"},$e={class:"text-slate-500 mb-[5px] font-bold"},Ue={class:"flex items-center mt-[5px]"},ke={class:"text-slate-500 mb-[5px] font-bold"},Ne=Ie(()=>a("br",null,null,-1)),Ee={class:"text-slate-500 mb-[5px] font-bold"},Be={class:"flex items-center mt-[5px]"},Ae={class:"text-slate-500 mb-[5px] font-bold"},Fe={class:"text-shadow text-white"},je={class:"flex items-center mt-[5px]"},ze={class:"mr-[10px]"},De={class:"text-slate-500 mb-[5px] font-bold flex items-center"},Pe={class:"max-w-[300px]"},Je={class:"flex items-center mt-[5px]"},Te={class:"mt-5 flex justify-end"},Le=z({__name:"index",setup(p){const h=Q(),f=W(),v=D(),m=b(""),g=b(null),S=b(!1),C=X().siteSetting,r=b({...C});function $({file:s,event:n}){const i=JSON.parse((n==null?void 0:n.target).response);return r.value.loginBackgroundUrl=i.data.imageUrl,s}async function U(){let s=m.value;if(S.value)try{s=await y()}catch{return}r.value.favicoUrl=s,S.value=!1,await c(),A()}async function c(){try{await ue(r.value),v.success(d("common.saveSuccess"))}catch(s){v.error(d("common.saveFail")),console.error(s)}}function _(s){const n=s.target;if(n.files&&n.files[0]){const i=n.files[0],O=URL.createObjectURL(i);m.value=O,g.value=i}}async function y(){let s="";if(g.value){const n=new FormData;n.append("imgfile",g.value),n.append("type",String(F.CardIcon)),await ee.post("/api/panel/globalSetting/uploadFaviconImage",n,{headers:{"Content-Type":"multipart/form-data",token:h.token}}).then(i=>{if(i.data.code!==0)throw i.data.code===1301&&v.error(`${d("apps.globalSetting.favicon")}: ${d("apiErrorCode.1301")}`),new Error(`upload error API:${i.data.msg}`);s=i.data.data.imageUrl}).catch(i=>{throw console.error("upload error",i),i})}return s}function G(){document.getElementById("fileIcoUpload").click(),S.value=!0}function H(){g.value=null,m.value="",S.value=!1}function M(){r.value={...C},m.value=C.favicoUrl,U()}async function A(){try{const{data:s}=await pe();r.value=s,m.value=s.favicoUrl}catch(s){B(s)}}return P(()=>{A()}),(s, n)=>(J(),Y("div",we,[t(e(T),{style:{"border-radius":"10px"},size:"small"},{default:l(()=>[t(e(L),null,{default:l(()=>[u(o(e(d)("apps.globalSetting.personalise")),1)]),_:1}),a("div",null,[a("div",$e,[u(o(s.$t("apps.globalSetting.title"))+" ",1),t(e(k))]),t(e(N),{show:e(f).proIsExpired},{default:l(()=>[a("div",Ue,[t(e(E),{value:r.value.title,"onUpdate:value":n[0]||(n[0]= i=>r.value.title=i),type:"text","show-count":"",maxlength:20,placeholder:e(d)("common.inputPlaceholder")},null,8,["value","placeholder"])])]),_:1},8,["show"])]),t(e(I)),a("div",null,[a("div",ke,[u(o(s.$t("apps.globalSetting.favicon"))+" ",1),t(e(k))]),t(e(N),{show:e(f).proIsExpired},{default:l(()=>[a("div",null,[t(e(ie),{width:"100",style:{width:"80px",height:"80px",border:"1px solid #e9e9e9"},src:m.value,"preview-disabled":""},null,8,["src"]),Ne,t(e(ce),{size:"small"},{default:l(()=>[t(e(x),{for:"fileIcoUpload",onClick:G},{default:l(()=>[u(o(e(d)("apps.globalSetting.selectIcoImage")),1)]),_:1}),t(e(x),{for:"fileIcoUpload",disabled:m.value==="",onClick:H},{default:l(()=>[u(o(e(d)("apps.globalSetting.clearIcoImage")),1)]),_:1},8,["disabled"])]),_:1}),a("input",{id:"fileIcoUpload",type:"file",accept:".ico",style:{display:"none"},onChange:_},null,32)])]),_:1},8,["show"])]),t(e(I)),a("div",null,[a("div",Ee,[u(o(s.$t("apps.globalSetting.isEnableLoginCaptcha"))+" ",1),t(e(k))]),t(e(N),{show:e(f).proIsExpired},{default:l(()=>[a("div",Be,[t(e(j),{value:r.value.isEnableLoginCaptcha,"onUpdate:value":n[1]||(n[1]= i=>r.value.isEnableLoginCaptcha=i)},null,8,["value"])])]),_:1},8,["show"])]),t(e(I)),a("div",null,[a("div",Ae,o(s.$t("apps.globalSetting.loginBackgroundImage")),1),t(e(le),{action:"/api/file/uploadImg","show-file-list":!1,name:"imgfile",headers:{token:e(h).token},data:{type:e(F).Wallpaper},"directory-dnd":!0,onFinish:$},{default:l(()=>[t(e(oe),{style:{width:"100%"}},{default:l(()=>[a("div",{class:"h-[200px] w-full border bg-slate-100 flex justify-center items-center cursor-pointer rounded-[10px]",style:Z({background:`url(${r.value.loginBackgroundUrl}) no-repeat`,backgroundSize:"cover"})},[a("div",Fe,o(s.$t("apps.baseSettings.uploadOrDragText")),1)],4)]),_:1})]),_:1},8,["headers","data"]),a("div",je,[a("span",ze,o(s.$t("apps.globalSetting.customImageURL")),1)]),t(e(E),{value:r.value.loginBackgroundUrl,"onUpdate:value":n[2]||(n[2]= i=>r.value.loginBackgroundUrl=i),type:"text",size:"small",clearable:""},null,8,["value"])]),t(e(I)),a("div",null,[a("div",De,[u(o(s.$t("apps.globalSetting.isEnableItemCardCache"))+" ",1),t(e(ne),{class:"ml-2"},{default:l(()=>[a("div",Pe,o(e(d)("apps.globalSetting.isEnableItemCardCacheTip")),1)]),_:1})]),a("div",Je,[t(e(j),{value:r.value.isDisableItemCardCache,"onUpdate:value":n[3]||(n[3]= i=>r.value.isDisableItemCardCache=i),"checked-value":!1,"unchecked-value":!0},null,8,["value"])])]),a("div",Te,[t(e(R),{onPositiveClick:M},{trigger:l(()=>[t(e(x),{size:"small",type:"error"},{default:l(()=>[u(o(s.$t("common.reset")),1)]),_:1})]),default:l(()=>[u(" "+o(s.$t("apps.globalSetting.resetWarnText")),1)]),_:1}),t(e(x),{size:"small",type:"success",class:"ml-[10px]",style:{"margin-left":"5px"},onClick:U},{default:l(()=>[u(o(s.$t("common.save")),1)]),_:1})])]),_:1}),t(ye)]))}}),Xe=de(Le,[["__scopeId","data-v-b08a437c"]]);export{Xe as default};
